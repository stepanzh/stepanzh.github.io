<!DOCTYPE html>
<html lang="ru">
  <head>
        <title>stepanzh — SSH по верхам для программистов</title>
      <meta charset="utf-8" />
      <meta name="generator" content="Pelican" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <!-- Yandex.Metrika counter -->
      <script type="text/javascript" >
         (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
         m[i].l=1*new Date();
         for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
         k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
         (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

         ym(99933624, "init", {
              clickmap:true,
              trackLinks:true,
              accurateTrackBounce:true,
              webvisor:true
         });
      </script>
      <noscript><div><img src="https://mc.yandex.ru/watch/99933624" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
      <!-- /Yandex.Metrika counter -->

      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=PT+Mono&family=PT+Sans+Caption:wght@400;700&family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
      <link rel="stylesheet" type="text/css" href="https://stepanzh.github.io/theme/css/base.css" />
      <link rel="stylesheet" type="text/css" href="https://stepanzh.github.io/theme/css/highlight.css" />

      <!-- icons -->
      <link rel="icon" href="/favicon.ico" sizes="32x32">
      <link rel="apple-touch-icon" href="/apple-touch-icon.png">



    <meta name="description" content="Об SSH для тех, кто впервые им пользуется. Минимум команд и настроек для комфортной работы или строчки в резюме." />

    <meta name="keywords" content="ssh,secure shell,scp,ssh-keygen,ключи,настройка ssh,ssh конфиг,ssh config,ssh x11,ssh vscode,ssh git, ssh github" />

  </head>

  <body>
      <header class="page-header">
          <hgroup>
            <h1>
              <a class="site-name" href="https://stepanzh.github.io/">
                <img src="https://stepanzh.github.io/theme/images/galsia-transparent-500x500.png" />
                <span>stepanzh</span>
              </a>
            </h1>
          </hgroup>
          <nav class="nav-global">
            <span class="page-nav__item"><a href="https://stepanzh.github.io/"  aria-current="page" >Главная</a></span>
                <span class="page-nav__item"><a href="https://stepanzh.github.io/pages/about-proportio.html" >Пропорцио</a></span>
                <span class="page-nav__item"><a href="https://stepanzh.github.io/pages/stepan-zakharov-cv.html" >Резюме</a></span>
                <span class="page-nav__item"><a href="https://stepanzh.github.io/pages/my-projects.html" >Проекты</a></span>
                <span class="page-nav__item"><a href="https://stepanzh.github.io/pages/support-me.html" >Поддержать</a></span>
          </nav>
      </header>
      <main class="page-main">
  <article class="article">
    <header>
      <h2 class="article-heading">SSH по верхам для программистов</h2>
      
    </header>
    <blockquote class="epigraph">
Что я хотел бы знать об SSH при первом знакомстве.
Минимум команд и настроек для комфортной работы или строчки в резюме.</blockquote>
<div class="figure align-center">
<img alt="" src="https://stepanzh.github.io/images/ssh-101/cover.png" />
<p class="caption">рашн аксэнт</p>
</div>
<div class="section" id="ssh-ssh">
<h2>Что такое SSH и зачем SSH</h2>
<p>Представьте, что используете телеграмм-бот.
Вы нажали кнопку или отправили боту сообщение, и что-то получаете в ответ.
Под капотом вы посылаете команду, она исполняется, а потом вам присылается ответ.
Важно, что команда исполняется «где-то там», а не на вашем телефоне или компьютере.
Ваше устройство лишь <em>показывает</em> результат.
Это типичная ситуация общения по модели «клиент-сервер»: вы (client) просите оказать услугу (service) из списка доступных, а сервер её оказывает.</p>
<p>Технически, здесь три составляющие: телеграмм-клиент (ваше приложение), сервер (на нём исполняется бот) и инфраструктура, которую даёт Telegram (протоколы общения).
Фактически, вы управляете сервером, используя мобильник.</p>
<p>Более общим является <em>удалённый доступ</em> (от слова «далеко»).
Это когда вы со своего компьютера исполняете команды на другом компьютере.
Ваш компьютер вот он, перед глазами: стационарник, ноутбук, телефон... <em>локальная машина</em>.
А другой компьютер «где-то там»: сервер, кластер, телевизор, чайник, роутер... <em>удалённая машина</em>.</p>
<p>Так вот...</p>
<!--  -->
<blockquote>
<a class="reference external" href="https://en.wikipedia.org/wiki/Secure_Shell">SSH</a> (secure shell) позволяет безопасно с одной машины управлять другой.
Как протокол, SSH предоставляет инфраструктуру.
А чтобы ей воспользоваться, реализация SSH предоставляет набор программ, например, <code>ssh</code>, <code>scp</code> и <code>ssh-keygen</code>.</blockquote>
<p>До SSH были популярны <a class="reference external" href="https://en.wikipedia.org/wiki/Telnet">Telnet</a> и <a class="reference external" href="https://en.wikipedia.org/wiki/Remote_Shell">rsh</a>.
Они также предназначены для удалённого управления чем-нибудь, но не безопасны сегодня, особенно при выходе в глобальную сеть: их трафик не шифруется.</p>
<p>SSH сейчас это стандартный способ удалённого доступа.
Им пользуются бэкэндеры и сисадмины, чтобы настраивать сервера, а учёные и инженеры, чтобы запускать расчёты на каком-то быстром (дорогом) компьютере.</p>
</div>
<div class="section" id="section-1">
<h2>Подключение</h2>
<p>По ssh можно подключиться двумя способами: <em>по ключу</em> или <em>по паролю</em>.
Подключение по паролю неудобно и менее безопасно.
По-хорошему, оно вовсе должно быть отключено на сервере.</p>
<p>В обоих случаях команда подключения одинакова.</p>
<div class="highlight"><pre><span></span>ssh<span class="w"> </span>pupkin@192.168.0.1
</pre></div>
<p>Саму команду можно прочитать так: «подключиться к аккаунту <code>pupkin</code> на сервере с адресом <code>192.168.0.1</code>».
И имя аккаунта, и адрес сервера вам должен кто-то дать.</p>
<p>После команды вы увидите сообщение типа «добавить ли сервер в список и подключиться», тут вводим <code>y</code> (yes).
Потом возможно несколько ситуаций.</p>
<ol class="arabic simple">
<li>Просят пароль: вводите пароль от аккаунта <code>pupkin</code> на сервере.</li>
<li><code>No matching key exchange found</code>.
Это хорошо: доступ по паролю закрыт, просто у вас ещё не сгенерирован ключ.
Об этом ниже.</li>
<li>Просто подключаетесь: вы увидите приветствие и промпт <a class="reference external" href="https://stepanzh.github.io/command-line-101.html">командной оболочки</a> на сервере, например, <code>$ pupkin&#64;super-server:~</code>.
Вы внутри.</li>
</ol>
<p>После первого успешного подключения у вас ещё появится файл <code>~/.ssh/known_hosts</code>.
Это список серверов и их ключей/подписей.
По ним ваш ssh клиент проверяет подлинность входящих сообщений.</p>
</div>
<div class="section" id="section-2">
<h2>Ключи</h2>
<p>В протоколе SSH для шифрования трафика используются ключи.
Ваш пэ-ка использует пару ключей, и сервер использует пару ключей.
Ключи нужны, чтобы подписывать каждое сообщение, которыми два компа обмениваются.
Так они распознают (authenticate) друг друга и, в конце концов, доверяют.
(Вы когда-нибудь просили записать кружок, когда друг попросил скинуть тыщу? Ну вот это оно.)</p>
<p>Чтобы подключаться по ключу, нужно два действия.</p>
<ol class="arabic simple">
<li>Создать пару ключей на своей машине.</li>
<li>Положить публичный ключ на удалённую машину.</li>
</ol>
<div class="section" id="section-3">
<h3>Создаём ключи</h3>
<p>Создаются ключи утилитой <code>ssh-keygen</code>.</p>
<div class="highlight"><pre><span></span>ssh-keygen<span class="w"> </span>-t<span class="w"> </span>ed25519<span class="w"> </span>-C<span class="w"> </span><span class="s1">&#39;pupkin desktop&#39;</span>
</pre></div>
<ul class="simple">
<li><code>Enter file in which to save the key</code>.
Жмите <span class="kbd">Enter</span>, пусть ключи сохраняются в стандартное место.</li>
<li><code>Enter passphrase</code>.
Просто жмите <span class="kbd">Enter</span>.</li>
<li><code>Enter same passphrase again</code>.
<span class="kbd">Enter</span>!</li>
</ul>
<p>Что мы тут ввели?</p>
<ul class="simple">
<li><code>-t ed25519</code>.
Используемый алгоритм шифрования.
Ed25519 рекомендуется в 2025-ом, можете чекнуть, что рекомендует <a class="reference external" href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">github</a>.
Ну или спросите админа: иногда сервер какие-то типы ключей не принимает.</li>
<li><code>-C 'pupkin desktop'</code>.
Это комментарий для человеков, он помещается в конец файла с публичным ключ.
Нужен вам, чтобы отличать машины, с которых вы подключаетесь к серверу.
Нужен админу, чтобы понимать, чей ключ лежит на сервере.</li>
</ul>
<p>В итоге, в папке <code>~/.ssh/</code> появятся два файла.</p>
<ul class="simple">
<li><code>~/.ssh/id_ed25519</code>.
Это приватный ключ.
Его вообще никому нельзя показывать, даже своему терминалу.
Если у вас скоммуниздят или капитализируют приватный ключ, то смогут подключаться от вашего имени.
Баг или фича 🤔</li>
<li><code>~/.ssh/id_ed25519.pub</code>.
А это публичный ключ.
Можно всем хвастаться его длиной.</li>
</ul>
<div class="highlight"><pre><span></span>cat<span class="w"> </span>~/.ssh/id_ed25519.pub
ssh-ed25519<span class="w"> </span>AAAAC3NzaC1lZDI1NTE5AAAAIJdD9cOqjBt+TIhWFEk+dNUtx0rsxV9uGE7S6+O1YnU3<span class="w"> </span>pupkin<span class="w"> </span>desktop
</pre></div>
<p>Заметили комментарий? ☝️</p>
</div>
<div class="section" id="section-4">
<h3>Кладём публичный ключ на сервер</h3>
<p>Чтобы сервер вас узнал (узнал ваш компьютер), нужно покласть ваш <em>публичный</em> ключ на сервер.
Это должен делать админ: нужно ему скинуть файл <code>~/.ssh/id_чё-то-там.pub</code>.
(И надеяться, что он не покласт на вашу просьбу.)</p>
<p>Но, допустим, что у вас есть доступ по паролю, и вы хотите положить ключ сами.
Тогда вы делаете так.</p>
<p>Закидываете файл с ключом на сервер (scp разберём позже).</p>
<div class="highlight"><pre><span></span>scp<span class="w"> </span>~/.ssh/id_ed25519.pub<span class="w"> </span>pupkin@192.168.0.1:~
</pre></div>
<p>Подключаетесь по паролю</p>
<div class="highlight"><pre><span></span>ssh<span class="w"> </span>pupkin@192.168.0.1
</pre></div>
<p>Кладёте ключ в <code>~/.ssh/authorized_keys</code></p>
<div class="highlight"><pre><span></span><span class="c1"># На сервере</span>

mkdir<span class="w"> </span>-p<span class="w"> </span>~/.ssh
cat<span class="w"> </span>~/id_ed25519.pub<span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.ssh/authorized_keys
cat<span class="w"> </span>~/.ssh/authorized_keys
rm<span class="w"> </span>~/id_ed25519.pub
</pre></div>
<p>Что произошло?</p>
<ol class="arabic simple">
<li>Создали папку <code>~/.ssh</code>, если её ещё нет.</li>
<li>Дописали публичный ключ в файл <code>~/.ssh/authorized_keys</code>.
Это список ключей, которым сервер доверяет для подключения к аккаунту <code>pupkin</code>.
(Ну или вообще к тому, в чьём хоуме это лежит.)
В списке может быть много ключей, так вы можете подключаться с разных устройств.</li>
<li>Проверили, что ключ записался.</li>
<li>Удалили ключ, чтоб больше не мешался.</li>
</ol>
<p>Готово.</p>
<div class="highlight"><pre><span></span>Ваша машина            Сервер
---------------------  ---------------------------------
~/.ssh/id_ed25519      /etc/ssh/ssh_host_ed25519
~/.ssh/id_ed25519.pub  /etc/ssh/ssh_host_ed25519.pub
~/.ssh/known_hosts     /home/pupkin/.ssh/authorized_keys

~/.ssh/config          /etc/ssh/ssh_config
                       /etc/ssh/sshd_config
</pre></div>
</div>
<div class="section" id="permission-denied-id-ed25519-pub">
<h3>Permission denied id_ed25519.pub</h3>
<p>Если <em>при подключении</em> вы видите сообщение о том, что для какого-то ssh файла (например, ключа) нет доступа, то что-то не так с правами на этот файл.
Чтоб всё работало, на локальной машине вы должны иметь права на чтение и запись всего, что лежит в <code>~/.ssh</code>, а на сервере такие права должны быть у юзера <code>pupkin</code>.
У меня такой косяк вспыл, когда я из-под рута положил себе ключ (владелец <code>root</code>, а не <code>pupkin</code>) плюс до меня на локальной машине что-то не моё было в <code>~/.ssh</code>.</p>
</div>
</div>
<div class="section" id="section-5">
<h2>Перекидываем файлы</h2>
<p>SCP (secure copy) это утилита для передачи файлов по ssh.
Она обычно устанавливается вместе с ssh клиентом.</p>
<p>Синтаксис <code>scp</code> мимикрирует синтаксис <code>cp</code>.</p>
<div class="highlight"><pre><span></span>scp<span class="w"> </span>~/documents/some-data.tar<span class="w"> </span>pupkin@192.68.0.1:~/temporary/
</pre></div>
<p>Так локальный файл <code>~/documents/some-data.tar</code> отправляется (копируется) на удалённую машину.
В итоге на сервере появится файл <code>/home/pupkin/temporary/some-data.tar</code>.</p>
<!--  -->
<blockquote>
Всё отличие от <code>cp</code> только во втором аргументе: прежде чем указать путь, необходимо указать адрес машины и поставить двоеточие.</blockquote>
<ul class="simple">
<li>После того, как вы ввели <code>pupkin&#64;192.68.0.1:~/</code> пожмакайте <span class="kbd">Tab</span>.
По-хорошему, должна сработать подсказка для пути.</li>
<li>С опцией <code>-r</code> вы можете отправлять <a class="reference external" href="https://stackoverflow.com/questions/11304895/how-do-i-copy-a-folder-from-remote-to-local-using-scp">целые папки</a>.</li>
</ul>
<p>Если вы не используете подключение по ключу, то <code>scp</code> будет на каждый чих требовать пароль.
Используйте ключи!</p>
</div>
<div class="section" id="section-6">
<h2>Конфиг</h2>
<div class="highlight"><pre><span></span>Host mlcluster
  HostName 192.168.0.1
  User pupkin
</pre></div>
<p>Некст левел для упрощения жизни после настройки ключей это настройка конфига.
Базовый конфиг вверху, его стандартное место это <code>~/.ssh/config</code>.</p>
<p>Теперь pupkin может подключаться к серверу такой командой.</p>
<div class="highlight"><pre><span></span>ssh<span class="w"> </span>mlcluster
</pre></div>
<p>А отправлять файлы вот так.</p>
<div class="highlight"><pre><span></span>scp<span class="w"> </span>some-data.tar<span class="w"> </span>mlcluster:~/temporary/
</pre></div>
<p>Можно считать <code>mlcluster</code> shorthand-ом для <code>pupkin&#64;192.168.0.1</code>: не надо запоминать юзернэйм и адрес сервера.</p>
<p>В конфиге много настроек.
Например, можно указать какой ключ использовать (когда у вас их несколько) или смэтчить настройки клиента и сервера (чтоб не ругались).</p>
<div class="figure align-center">
<img alt="" src="https://stepanzh.github.io/images/common/kolobok-zagar.png" style="width: 256px;" />
</div>
</div>
<div class="section" id="section-7">
<h2>Клиенты</h2>
<p>SSH-клиент (ssh client) это программа, которой вы пользуетесь, чтобы работать по SSH.
Клиенты бывают разные, я пользовался только стандартным OpenSSH, из командной строки.
На Windows его можно получить при установке <a class="reference external" href="https://git-scm.com/downloads">git</a>, на MacOS и Ubuntu он предустановлен.
Но есть и графические клиенты, я слышал про PuTTY для Windows.</p>
</div>
<div class="section" id="x11">
<h2>X11</h2>
<p>X Window System (она же X, X11 или «иксы») позволяет работать с графическими программами: вы видите морду приложения, жмакаете кнопки, а реально она исполняется на сервере.
Например, на сервере установлен <a class="reference external" href="https://gnuplot.sourceforge.net/demo_6.0/">gnuplot</a>, и вы хотите построить график прям с сервера, не перекидывая его (или данные) на свою машину.
Gnuplot поддерживает X11, но чтобы увидеть график, нужно подключиться к серверу с опцией <code>-X</code>.</p>
<div class="highlight"><pre><span></span>ssh<span class="w"> </span>-X<span class="w"> </span>mlcluster
</pre></div>
<ul class="simple">
<li>Если вы хотите всегда подключаться с X11, можно дописать строчку в конфиг.
Но бывает и так, что на сервере по умолчанию включена поддержка X11.</li>
<li>Более громоздкие программы тоже умеют работать поверх X11, например, COMSOL Multiphysics.</li>
<li>Чтобы проверить, что X11 подключение поддерживается, запустите на сервере что-нибудь простое: <code>xeyes</code> или <code>xclock</code>.
Появилось окошко?
Значит всё ок.</li>
<li>Поддерживать иксы должен уметь и сервер, и <em>ваш терминал</em>.
Например, Windows Terminal так не умеет (по крайней мере, из коробки).</li>
</ul>
</div>
<div class="section" id="jupyter-notebook">
<h2>Jupyter Notebook</h2>
<p>Можно исполнять код через jupyter на сервере, а работать в своём браузере.
Для этого...</p>
<p>На сервере запускаете jupyter в no-browser режиме.</p>
<div class="highlight"><pre><span></span><span class="c1"># На сервере</span>

jupyter<span class="w"> </span>notebook<span class="w"> </span>--no-browser<span class="w"> </span>--port<span class="o">=</span><span class="m">8080</span>
</pre></div>
<p>Подключаетесь к серверу с пробросом портов.</p>
<div class="highlight"><pre><span></span><span class="c1"># На локальной машине</span>

ssh<span class="w"> </span>-L<span class="w"> </span><span class="m">8080</span>:localhost:8080<span class="w"> </span>mlcluster
</pre></div>
<p>Открываете в своём браузере ссылку, которую вам выдал jupyter.</p>
</div>
<div class="section" id="github-gitlab">
<h2>GitHub / GitLab</h2>
<p>Мне бывает удобно писать код на локальном компе, а запускать на удалённом.
Чтобы не пользоваться <code>scp</code>, я пушу код со своей машины, а пулю на удалённой.
Чтобы было удобно, можно на сервере сгенерировать ключи и публичный сообщить гитхабу / гитлабу.</p>
</div>
<div class="section" id="ide">
<h2>IDE</h2>
<p>Современные IDE, вроде продуктов Jetbrains или VSCode умеют подключаться по SSH на сервер.
Как и с X11 вы таскаете файлы и комитите тут, а на самом деле всё происходит там.
Довольно удобно.
Знайте что такая опция есть.</p>
</div>
<div class="section" id="section-8">
<h2>В итоге</h2>
<p>В итоге SSH не страшная штука.
Команд, о которых я рассказал, реально достаточно для работы (полу)программиста.
Вам стоит понимать, что такое ключи, и научиться пользоваться двумя-тремя командами.
Попробуйте поработать с SSH через терминал (особенно, на *nix системах), а если надоест, проверьте, поддерживают ли ваши инструменты SSH.</p>
</div>

    <footer class="article-footer">
      <p class="article-date">
        <time datetime="2025-09-29T00:00:00+03:00">2025-09-29</time>      </p>
      <section class="article-footer__actions">
        <div><a href="https://stepanzh.github.io/pages/support-me.html" rel="bookmark">❤️ Поблагодарить автора</a></div>
        <div><a href="https://t.me/stepanzh_blog" rel="nofollow">👀 Подписаться на новости</a></div>
      </section>
    </footer>
  </article>
      </main>
      <footer class="page-footer">
          <p>&copy; Захаров Степан</p>
          <p>Сайт создан с помощью <a target="_blank" rel="nofollow" href="https://getpelican.com/">Pelican</a></p>
      </footer>
  </body>
</html>